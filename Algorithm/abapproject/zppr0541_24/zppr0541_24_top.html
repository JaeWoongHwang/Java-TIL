<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZPPR0541_24_TOP</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZPPR0541_24_TOP</b></font>
<br>
<font size="3" face = "Arial" color="#000000"><b>Description:  Include ZPPR0541_24_TOP</b></font>
<hr>
<pre width="100">
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Include ZPPR0541_24_TOP                                   Report ZPPR0541_24</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
TABLES : pbim,sscrfields,rlgrap,t001w.
DATA l_name(40).
DATA : BEGIN OF gt_itab OCCURS 0,
<font color ="#0000FF">*       G_BOX(1),</font>
         g_icon(4),
         versb          LIKE pbim-versb,
         matnr          LIKE mara-matnr,
         maktx          LIKE makt-maktx,
         mtart          LIKE mara-mtart,
         matkl          LIKE mara-matkl,
         lvorm          LIKE marc-lvorm,
         mmsta          LIKE marc-mmsta,
         filed1         LIKE mseg-menge,
         filed2         LIKE mseg-menge,
         filed3         LIKE mseg-menge,
         filed4         LIKE mseg-menge,
         filed5         LIKE mseg-menge,
         filed6         LIKE mseg-menge,
         filed7         LIKE mseg-menge,
         filed8         LIKE mseg-menge,
         filed9         LIKE mseg-menge,
         filed10        LIKE mseg-menge,
         filed11        LIKE mseg-menge,
         filed12        LIKE mseg-menge,
         filed13        LIKE mseg-menge,
         filed14        LIKE mseg-menge,
         filed15        LIKE mseg-menge,
         filed16        LIKE mseg-menge,
         filed17        LIKE mseg-menge,
         filed18        LIKE mseg-menge,
         filed19        LIKE mseg-menge,
         filed20        LIKE mseg-menge,
         filed21        LIKE mseg-menge,
         filed22        LIKE mseg-menge,
         filed23        LIKE mseg-menge,
         filed24        LIKE mseg-menge,
         filed25        LIKE mseg-menge,
         filed26        LIKE mseg-menge,
         filed27        LIKE mseg-menge,
         filed28        LIKE mseg-menge,
         filed29        LIKE mseg-menge,
         filed30        LIKE mseg-menge,
         total          LIKE mseg-menge,
         g_type(1),
         bdc_type(1),
         g_message(200),
         field_style    TYPE lvc_t_styl,
       END OF gt_itab .

DATA : gs_itab LIKE gt_itab.

DATA : BEGIN OF gt_temp OCCURS 0,
         g_icon       LIKE icon-name,
         versb        LIKE pbim-versb,
         pbdnr        LIKE pbim-pbdnr,
         matnr        LIKE pbim-matnr,
         maktx        LIKE makt-maktx,
         mtart        LIKE mara-mtart,
         matkl        LIKE mara-matkl,
         message(200),
       END OF gt_temp.

DATA : BEGIN OF gt_list OCCURS 0.
    INCLUDE STRUCTURE gt_temp.
DATA:
  celltab TYPE lvc_t_styl,
  zmark.
DATA : END OF gt_list.

DATA : gs_list LIKE gt_list.

DATA : BEGIN OF gt_excel OCCURS 0,
         versb          LIKE pbim-versb,
         matnr          LIKE mara-matnr,
         maktx          LIKE makt-maktx,
         m1             LIKE mseg-menge,
         m2             LIKE mseg-menge,
         m3             LIKE mseg-menge,
         m4             LIKE mseg-menge,
         m5             LIKE mseg-menge,
         m6             LIKE mseg-menge,
         m7             LIKE mseg-menge,
         m8             LIKE mseg-menge,
         m9             LIKE mseg-menge,
         m10            LIKE mseg-menge,
         m11            LIKE mseg-menge,
         m12            LIKE mseg-menge,
         g_type(1),
         g_message(200),
       END OF gt_excel.

DATA: BEGIN OF month_upload OCCURS 0,
        filed1(20) TYPE c,
        filed2(18) TYPE c,
        filed3(20) TYPE c,
        filed4(20) TYPE c,
        filed5(20) TYPE c,
        filed6(20) TYPE c,
        filed7(20) TYPE c,
        filed8(20) TYPE c,
      END OF month_upload.

DATA: BEGIN OF year_upload OCCURS 0,
        filed1(20)  TYPE c,
        filed2(18)  TYPE c,
        filed3(20)  TYPE c,
        filed4(20)  TYPE c,
        filed5(20)  TYPE c,
        filed6(20)  TYPE c,
        filed7(20)  TYPE c,
        filed8(20)  TYPE c,
        filed9(20)  TYPE c,
        filed10(20) TYPE c,
        filed11(20) TYPE c,
        filed12(20) TYPE c,
        filed13(20) TYPE c,
        filed14(20) TYPE c,
        filed15(20) TYPE c,
      END OF year_upload.

DATA : BEGIN OF gt_mara OCCURS 0,
         matnr LIKE mara-matnr,
         matkl LIKE mara-matkl,
         mtart LIKE mara-mtart,
         lvorm LIKE marc-lvorm,
         mmsta LIKE marc-mmsta,
       END OF gt_mara.

DATA : BEGIN OF gt_mast OCCURS 0,
         matnr LIKE mast-matnr,
         werks LIKE mast-werks,
         stlan LIKE mast-stlan,
         stlnr LIKE mast-stlnr,
         stlal LIKE mast-stlal,
       END OF gt_mast.

DATA : BEGIN OF gt_mapl OCCURS 0,
         matnr LIKE mapl-matnr,
         werks LIKE mapl-werks,
         plnty LIKE mapl-plnty,
         plnnr LIKE mapl-plnnr,
         plnal LIKE mapl-plnal,
         zkriz LIKE mapl-zkriz,
         zaehl LIKE mapl-zaehl,
       END OF gt_mapl.

DATA : BEGIN OF gt_mkal OCCURS 0,
         matnr LIKE mkal-matnr,
         werks LIKE mkal-werks,
         verid LIKE mkal-verid,
       END OF gt_mkal.

DATA : BEGIN OF gt_makt OCCURS 0,
         matnr LIKE makt-matnr,
         maktx LIKE makt-maktx,
       END OF gt_makt.

DATA : BEGIN OF m_date OCCURS 5,
         m_low  LIKE sy-datum,
         m_high LIKE sy-datum,
         sum    LIKE vtbbewe-atage,
       END OF m_date.

DATA : BEGIN OF m_day OCCURS 0,
         day      LIKE sy-datum,
         day1     LIKE sy-datum,
         daynr    LIKE hrvsched-daynr,
         type(01),
         week(10),
         sum(02)  TYPE i,
       END OF  m_day.

DATA : BEGIN OF gt_sum OCCURS 0,
         day1    LIKE sy-datum,
         sum(02) TYPE i,
       END OF gt_sum.

DATA : BEGIN OF y_date OCCURS 0,
         month(07),
         day       LIKE sy-datum,
       END OF y_date.

DATA : p_date LIKE sy-datum.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& ########</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>

DATA : p_pltgb LIKE zppt026_04-pltgb.
DATA : p_pltch LIKE zppt026_04-pltch.

RANGES : gr_mtart FOR mara-mtart.
RANGES : gr_versb FOR pbim-versb.
RANGES : gr_pdatu FOR pbed-pdatu.

DATA : g_lines TYPE i.
DATA : g_count TYPE i.

<font color ="#0000FF">*----------------------------------------------------------------------*</font>
<font color ="#0000FF">*  Macro                                                              *</font>
<font color ="#0000FF">*----------------------------------------------------------------------*</font>
<font color ="#0000FF">* Ranges Macro</font>


DEFINE %%range_set.
  IF &2 IS INITIAL AND &3 IS INITIAL.
  ELSEIF NOT &2 IS INITIAL AND &3 IS INITIAL.
    CLEAR : &1-high.
    MOVE: 'I'    TO &1-sign,
          'EQ'   TO &1-option,
          &2     TO &1-low.
    APPEND &1    TO &1.
  ELSE.
    MOVE: 'I'    TO &1-sign,
          'BT'   TO &1-option,
           &2    TO &1-low,
           &3    TO &1-high.
    APPEND &1    TO &1 .
  ENDIF.
END-OF-DEFINITION.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&  F4 ######  ##                                              *</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*-- DATA</font>
DATA : g_subrc(1).

DATA :l_dynpfld LIKE help_info-dynprofld,
      l_dynprog LIKE sy-repid,
      l_dynnr   LIKE sy-dynnr,
      l_retfild LIKE dfies-fieldname,
      lt_fields TYPE TABLE OF dfies,
      ls_field  TYPE dfies.

DATA: BEGIN OF mf_dynpfields OCCURS 1.
    INCLUDE STRUCTURE dynpread.
DATA: END OF mf_dynpfields.

DATA: mf_returncode LIKE sy-subrc,
      mf_monat      LIKE isellist-month,
      mf_hlp_repid  LIKE sy-repid.
<font color ="#0000FF">*---Display Header</font>
DATA : gs1(9) TYPE n,
       gs2(9) TYPE n,
       gs3(9) TYPE n,
       gs4(9) TYPE n,
       gs5(9) TYPE n,
       gs6(9) TYPE n.

DATA : g_werks(4).
DATA : g_name1 LIKE t001w-name1.
DATA : g_date LIKE sy-datum.
DATA : text1(42).
DATA : name1(49).
DATA : text2(13).
DATA : low1(30).
DATA : p_namber(40).

<font color ="#0000FF">*---BDC DATA</font>
DATA : BEGIN OF bdc_tab OCCURS 0.
    INCLUDE STRUCTURE bdcdata.
DATA : END OF bdc_tab.

DATA : BEGIN OF gt_message OCCURS 0.
    INCLUDE STRUCTURE bdcmsgcoll.
DATA : END OF gt_message.

DATA : s_date LIKE sy-datum.
DATA : e_date LIKE sy-datum.
DATA : versb-low LIKE pbim-versb.
DATA : versb-high LIKE pbim-versb.
<font color ="#0000FF">* GUI Stats</font>
DATA : BEGIN OF gt_menutab OCCURS 10,
         fcode LIKE sy-ucomm,
       END OF gt_menutab.

<font color ="#0000FF">*---CLASS ALV DATA</font>
DATA : g_container          TYPE scrfname VALUE 'ALV_GRID_CONTAINER',
       g_docking_container  TYPE REF TO cl_gui_docking_container,
       g_docking_container2 TYPE REF TO cl_gui_docking_container,
       g_docking_container3 TYPE REF TO cl_gui_docking_container,
       g_custom_container   TYPE REF TO cl_gui_custom_container,
       g_top_of_page        TYPE REF TO cl_gui_container,
       g_grid               TYPE REF TO cl_gui_alv_grid,
       g_grid2              TYPE REF TO cl_gui_alv_grid,
       g_s_layout           TYPE lvc_s_layo,
       gs_variant           TYPE disvariant,
       g_t_fieldcat         TYPE lvc_t_fcat,
       g_t_fieldcat2        TYPE lvc_t_fcat,
       gs_fieldcat          TYPE lvc_s_fcat,
       gt_sort              TYPE lvc_t_sort,
       gt_sort2             TYPE lvc_t_sort,
       gs_sort              TYPE lvc_s_sort,
       document             TYPE REF TO cl_dd_document,
       splitter             TYPE REF TO cl_gui_splitter_container,
       html_control         TYPE REF TO cl_gui_html_viewer,
       parent1              TYPE REF TO cl_gui_container,
       parent2              TYPE REF TO cl_gui_container,
       gt_toolbar_excluding TYPE ui_functions.

DATA: l_spos   TYPE i,
      l_no     TYPE i,
      l_answer.
DATA : ls_sort TYPE lvc_s_sort.
DATA : ok_code LIKE sy-ucomm.
DATA : save_code LIKE sy-ucomm.
DATA :it_row  TYPE lvc_t_row,
      it_roid TYPE lvc_t_roid,
      wa_roid LIKE LINE OF it_roid.

DATA: BEGIN OF gs_parm,
        ttext        LIKE tstct-ttext,
        tcode        LIKE sy-tcode,
        userid       TYPE uname,
        modify,
        error,
        cursor_field TYPE scrfname,
        changed,
        first,
        rows         TYPE numc4,
        ok,
        save,
        sel_parm,         "selection screen parmeter check

      END OF gs_parm.

DEFINE __add_gap.
  CALL METHOD o_document-&gt;add_gap
    EXPORTING
      width = &1.
END-OF-DEFINITION.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& CLASS DECLARATIONS</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
CLASS lcl_event_receiver DEFINITION DEFERRED.
DATA : event_receiver TYPE REF TO lcl_event_receiver.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&       Class LCL_EVENT_RECEIVER</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*        Text</font>
<font color ="#0000FF">*----------------------------------------------------------------------*</font>
CLASS lcl_event_receiver DEFINITION.
  PUBLIC SECTION .
    METHODS:
      handle_toolbar
                    FOR EVENT toolbar OF cl_gui_alv_grid
        IMPORTING sender e_object e_interactive,

      handle_data_changed
                    FOR EVENT data_changed OF cl_gui_alv_grid
        IMPORTING sender er_data_changed ,

      handle_user_command
                    FOR EVENT user_command OF cl_gui_alv_grid
        IMPORTING e_ucomm ,

      handle_double_click
                    FOR EVENT double_click OF cl_gui_alv_grid
        IMPORTING sender e_row e_column,

      handle_top_of_page
                    FOR EVENT top_of_page OF cl_gui_alv_grid
        IMPORTING e_dyndoc_id,


      handle_close
                    FOR EVENT close OF cl_gui_dialogbox_container
        IMPORTING sender.

ENDCLASS. "
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&       Class (Implementation)  LCL_EVENT_RECEIVER</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*        Text</font>
<font color ="#0000FF">*----------------------------------------------------------------------*</font>
CLASS lcl_event_receiver IMPLEMENTATION.
<font color ="#0000FF">*--Handle Toolbar</font>
  METHOD handle_toolbar.
    PERFORM handle_toolbar USING sender e_object e_interactive .
  ENDMETHOD .                    "handle_toolbar

<font color ="#0000FF">*--Handle Data Changed</font>
  METHOD handle_data_changed .
    PERFORM handle_data_changed USING sender er_data_changed .
  ENDMETHOD.                    "handle_data_changed

  METHOD handle_top_of_page.
    PERFORM event_top_of_page USING   e_dyndoc_id.
  ENDMETHOD.                    "handle_TOP_OF_PAGE

<font color ="#0000FF">*--Handle User Command</font>
  METHOD handle_user_command .
    PERFORM handle_user_command USING e_ucomm .
  ENDMETHOD.                    "handle_user_command

  METHOD handle_double_click.
    CLEAR : gt_itab, gs_itab.
    READ TABLE gt_itab INDEX e_row-index INTO gs_itab.
    IF sy-subrc = 0.
      PERFORM call_transactions_md63.
    ENDIF.
  ENDMETHOD.                    "handle_double_click

  METHOD handle_close.
    CALL METHOD sender-&gt;set_visible
      EXPORTING
        visible = space.
  ENDMETHOD.                    "HANDLE_CLOSE
ENDCLASS. "LCL_EVENT_RECEIVER IMPLEMENTATION
<font color ="#0000FF">*&---------------------------------------------------------------------</font>
<font color ="#0000FF">* SELECT-OPTIONS / PARAMETERS                                          *</font>
<font color ="#0000FF">*&---------------------------------------------------------------------</font>
SELECTION-SCREEN BEGIN OF BLOCK s1 WITH FRAME TITLE TEXT-002.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT (31) TEXT-002.
PARAMETERS: p_rad1 RADIOBUTTON GROUP ga1 USER-COMMAND p01.
SELECTION-SCREEN COMMENT 36(25) TEXT-003.
PARAMETERS: p_rad2 RADIOBUTTON GROUP ga1 DEFAULT 'X'.
SELECTION-SCREEN COMMENT 65(20) TEXT-004.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK s1.

SELECTION-SCREEN BEGIN OF BLOCK s3 WITH FRAME TITLE TEXT-032.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT (31) TEXT-032.
PARAMETERS: p_rad3 RADIOBUTTON GROUP ga2 USER-COMMAND p02.
SELECTION-SCREEN COMMENT 36(25) TEXT-033.
PARAMETERS: p_rad4 RADIOBUTTON GROUP ga2 DEFAULT 'X'.
SELECTION-SCREEN COMMENT 65(20) TEXT-034.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK s3.

SELECTION-SCREEN BEGIN OF BLOCK s2 WITH FRAME TITLE TEXT-001.

PARAMETERS: p_year LIKE mseg-mjahr MODIF ID y1.

PARAMETERS: p_month LIKE zsdt2052_04-zmont MODIF ID m1.

PARAMETERS: p_pbdnr LIKE pbim-pbdnr.

SELECTION-SCREEN SKIP 1.

SELECT-OPTIONS : s_werks FOR t001w-werks
                 OBLIGATORY NO-EXTENSION
                 NO INTERVALS MEMORY ID wrk.

SELECTION-SCREEN SKIP 1.

PARAMETERS : p_file LIKE rlgrap-filename
             OBLIGATORY DEFAULT TEXT-008.
SELECTION-SCREEN SKIP 1.
PARAMETER: p_c1 AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN END OF BLOCK s2.

SELECTION-SCREEN BEGIN OF BLOCK b4 WITH FRAME.

SELECTION-SCREEN COMMENT 1(70) TEXT-041.
SELECTION-SCREEN SKIP.
SELECTION-SCREEN COMMENT 1(70) TEXT-042.
SELECTION-SCREEN SKIP.
SELECTION-SCREEN COMMENT 1(70) TEXT-043.
SELECTION-SCREEN SKIP.
SELECTION-SCREEN COMMENT 1(70) TEXT-044.
SELECTION-SCREEN SKIP.
SELECTION-SCREEN COMMENT 1(70) TEXT-045.

SELECTION-SCREEN END OF BLOCK b4.

SELECTION-SCREEN FUNCTION KEY 1.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 750
</font>
</body>
</html>
